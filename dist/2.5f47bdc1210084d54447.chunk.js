webpackJsonp([2,7],{649:function(t,e,a){var s=a(87)(a(658),a(661),null,null);s.options.__file="D:\\Apache24\\htdocs\\iview-project-3.0\\src\\views\\daily\\addMyDaily.vue",s.esModule&&Object.keys(s.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),s.options.functional&&console.error("[vue-loader] addMyDaily.vue: functional components are not supported with templates, they should use render functions."),t.exports=s.exports},652:function(t,e,a){a(682);var s=a(87)(a(667),a(700),null,null);s.options.__file="D:\\Apache24\\htdocs\\iview-project-3.0\\src\\views\\daily\\weekDaily.vue",s.esModule&&Object.keys(s.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),s.options.functional&&console.error("[vue-loader] weekDaily.vue: functional components are not supported with templates, they should use render functions."),t.exports=s.exports},658:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{formData:Object},computed:{sumCost:function(){var t=0;return null!=this.formData.items&&(this.formData.items.map(function(e){t+=e.cost}),this.formData.sumCost=t),t},currentDate:function(){var t=this.formData.date;return t?t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate():"未选择"}},data:function(){return{index:1,loading:!1,workCategoryList:[{value:"编码",label:"编码"},{value:"测试",label:"测试"},{value:"文档编写",label:"文档编写"},{value:"自学",label:"自学"},{value:"翻译",label:"翻译"},{value:"准备工作",label:"准备工作"}]}},methods:{save:function(t){var e=this,a=this;this.$refs[t].validate(function(t){if(t){e.$Message.success("Success!"),e.loading=!0;var s=a.formData,o=new Date,n=o.getFullYear()+"-"+(o.getMonth()+1)+"-"+o.getDate();null!=s.id?a.updateDailyInfo([s.userName||"yh",s.date.getFullYear()+"-"+(s.date.getMonth()+1)+"-"+s.date.getDate(),s.assign,s.normalWork,s.overtimeWork,s.projectName,s.extendedField,s.projectAssign,s.firstLevelActivity,s.secondLevelActivity,s.firstLevelModule,s.secondLevelModule,s.workResultType,s.workResult,s.note||"",n,s.id]):a.addDailyInfo([s.userName,s.date.getFullYear()+"-"+(s.date.getMonth()+1)+"-"+s.date.getDate(),s.assign,s.normalWork,s.overtimeWork,s.projectName,s.extendedField,s.projectAssign,s.firstLevelActivity,s.secondLevelActivity,s.firstLevelModule,s.secondLevelModule,s.workResultType,s.workResult,s.note,n])}else e.$Message.error("Fail!")})},addDailyInfo:function(t){var e=this;this.$http.post("/api/daily/addDailyInfo",{infos:t},{}).then(function(t){console.log(t),e.goBack()})},updateDailyInfo:function(t){var e=this;this.$http.put("/api/daily/updateDailyInfo",{infos:t},{}).then(function(t){console.log(t),e.goBack()})},handleAdd:function(){this.index=this.formData.items.length+1,this.formData.items.push({workName:"",cost:0,workCategory:"",index:this.index})},handleRemove:function(t){this.formData.items.splice(t,1)}}}},659:function(t,e,a){"use strict";var s=a(118),o={buildBarEChart:function(t,e,a,o){s.init(document.getElementById(t)).setOption({color:["#3398DB"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:a,axisTick:{alignWithLabel:!0}}],yAxis:[{type:"value"}],series:[{name:o,type:"bar",barWidth:"60%",data:e}]})},buildLineEChart:function(t,e,a,o,n){s.init(document.getElementById(t)).setOption({title:{text:e},tooltip:{trigger:"axis"},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:a,axisTick:{alignWithLabel:!0}},yAxis:{type:"value"},legend:{data:o},series:n})}};e.a=o},661:function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Form",{ref:"formData",staticStyle:{width:"1000px",margin:"0 auto"},attrs:{model:t.formData,"label-width":80}},[a("FormItem",[a("Row",[a("Col",{attrs:{span:"10"}},[a("p",[t._v("日期："+t._s(t.currentDate))])])],1)],1),t._v(" "),a("FormItem",[a("Row",[a("Col",{staticStyle:{margin:"0 auto"},attrs:{span:"10"}},[a("p",{staticStyle:{"text-align":"center"}},[t._v("事项")])]),t._v(" "),a("Col",{staticStyle:{margin:"0 auto"},attrs:{span:"4"}},[a("p",{staticStyle:{"text-align":"center"}},[t._v("花费时间")])]),t._v(" "),a("Col",{staticStyle:{margin:"0 auto"},attrs:{span:"4"}},[a("p",{staticStyle:{"text-align":"center"}},[t._v("工作内容")])])],1)],1),t._v(" "),t._l(t.formData.items,function(e,s){return a("FormItem",{key:s,attrs:{label:String(s+1),prop:"items."+s+".value"}},[a("Row",[a("Col",{attrs:{span:"10"}},[a("Input",{attrs:{type:"text",placeholder:"请输入事项"},model:{value:e.workName,callback:function(a){t.$set(e,"workName",a)},expression:"item.workName"}})],1),t._v(" "),a("Col",{attrs:{span:"4"}},[a("InputNumber",{staticStyle:{"margin-left":"10px",width:"100%"},attrs:{min:0},model:{value:e.cost,callback:function(a){t.$set(e,"cost",a)},expression:"item.cost"}})],1),t._v(" "),a("Col",{attrs:{span:"4"}},[a("Select",{staticStyle:{"margin-left":"10px"},model:{value:e.workCategory,callback:function(a){t.$set(e,"workCategory",a)},expression:"item.workCategory"}},t._l(t.workCategoryList,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1)],1),t._v(" "),a("Col",{attrs:{span:"4",offset:"1"}},[a("Button",{on:{click:function(e){return t.handleRemove(s)}}},[t._v("删除")])],1)],1)],1)}),t._v(" "),a("FormItem",[a("Row",[a("Col",{attrs:{span:"4"}},[a("Button",{attrs:{type:"dashed",long:"",icon:"md-add"},on:{click:t.handleAdd}})],1)],1)],1),t._v(" "),a("FormItem",[a("Row",[a("Col",{attrs:{span:"10"}},[a("p",[t._v("总计")])]),t._v(" "),a("Col",{attrs:{span:"4"}},[a("p",{staticStyle:{"margin-left":"18px",width:"100%"}},[t._v(t._s(t.sumCost))])])],1)],1),t._v(" "),a("FormItem",[a("Row",[a("Col",{attrs:{span:"18"}},[a("Input",{staticStyle:{width:"100%"},attrs:{type:"textarea",placeholder:"备注",autosize:{minRows:3,maxRows:5}},model:{value:t.formData.ps,callback:function(e){t.$set(t.formData,"ps",e)},expression:"formData.ps"}})],1)],1)],1)],2)],1)},staticRenderFns:[]},t.exports.render._withStripped=!0},667:function(t,e,a){"use strict";function s(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}Object.defineProperty(e,"__esModule",{value:!0});var o=a(689),n=a.n(o),i=a(659);e.default={components:{weekdayDailyDisplay:n.a},mounted:function(){var t=this;this.$http.get("/api/myDaily/getSelectedWeek",{params:{weekNum:this.$router.history.current.query.weekNum}}).then(function(e){var a=e.body[0];null!=a&&(t.updateFlag=a.updateFlag,t.weekData=JSON.parse(a.weekData),t.weekData.monday.date=new Date(t.weekData.monday.date),t.weekData.tuesday.date=new Date(t.weekData.tuesday.date),t.weekData.wednesday.date=new Date(t.weekData.wednesday.date),t.weekData.thursday.date=new Date(t.weekData.thursday.date),t.weekData.friday.date=new Date(t.weekData.friday.date),t.weekData.saturday.date=new Date(t.weekData.saturday.date),t.weekData.sunday.date=new Date(t.weekData.sunday.date),t.timeInterval=a.timeInterval.split("-").map(function(t){return t.slice(0,4)+"-"+t.slice(4,6)+"-"+t.slice(6,8)}),t.weekNumber=a.weeks)})},computed:{weekDetail:function(){var t=this,e=this.calculateDailyCost(this.weekData),a=[],s=["月","火","水","木","金","土","日"],o=new Date(this.timeInterval[0]);return e.forEach(function(t,e){a.push({coding:t.coding,testing:t.testing,documentWriting:t.documentWriting,selfStudying:t.selfStudying,translate:t.translate,useless:t.useless})}),a.map(function(e,a){e.weekday=s[a],e.date=""===t.timeInterval?"":new Date(new Date(o).getTime()+864e5*a).toLocaleDateString()}),null!=document.getElementById("weekSumCostChart")&&i.a.buildBarEChart("weekSumCostChart",this.getSumCostByCategoryOneWeek(e),["编码","测试","文档编写","自学","翻译","准备工作"],"各种类工作时长直方图"),a}},data:function(){return{loading:!1,weekNumber:1,timeInterval:"",updateFlag:!1,weekData:{monday:{date:"",workInfos:[],ps:"",sumCost:0},tuesday:{date:"",workInfos:[],ps:"",sumCost:0},wednesday:{date:"",workInfos:[],ps:"",sumCost:0},thursday:{date:"",workInfos:[],ps:"",sumCost:0},friday:{date:"",workInfos:[],ps:"",sumCost:0},saturday:{date:"",workInfos:[],ps:"",sumCost:0},sunday:{date:"",workInfos:[],ps:"",sumCost:0}},weekOptions:{shortcuts:[{text:"本周",value:function(){var t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate()-t.getDay()+1),a=new Date(e);return a.setTime(e.getTime()+5184e5),[e,a]}}]},tableTitle:[{title:"星期",key:"weekday",width:"60"},{title:"日期",key:"date"},{title:"编码",key:"coding",width:"60"},{title:"测试",key:"testing",width:"60"},{title:"文档编写",key:"documentWriting",width:"60"},{title:"自学",key:"selfStudying",width:"60"},{title:"翻译",key:"translate",width:"60"},{title:"准备工作",key:"useless",width:"60"}]}},methods:{save:function(){var t=this;this.loading=!0;var e=this.getFormattedData(this.weekData);e.push(JSON.stringify(this.weekData)),this.updateFlag?this.openConfirmDailog(e):this.$http.post("/api/myDaily/importOriginData",{infos:[e]},{}).then(function(e){t.goBack()})},openConfirmDailog:function(t){var e=this;this.$Modal.confirm({title:"更新周报确认",content:"<p>Are you sure you want to update a current EXISTED WEEK DAILY RECORD?</p>",loading:!0,onOk:function(){e.$http.put("/api/myDaily/updateWeekData",{infos:t,weeks:e.$router.history.current.params.infos.weeks},{}).then(function(t){e.$Modal.remove(),e.goBack()})},onCancel:function(){e.loading=!1}})},goBack:function(){this.$router.push("/myDaily")},transformTimeInterval:function(t){if(""===t)return"未指定";var e=t[0].split("-"),a=t[1].split("-");return""+e[0]+e[1]+e[2]+"-"+a[0]+a[1]+a[2]},calculateDailyCost:function(t){var e=new Map,a=new Map,o=new Map,n=new Map,i=new Map,r=new Map,l=new Map;return e.set("monday",this.getEveryCategoryCost(t.monday.workInfos)),a.set("tuesday",this.getEveryCategoryCost(t.tuesday.workInfos)),o.set("wednesday",this.getEveryCategoryCost(t.wednesday.workInfos)),n.set("thursday",this.getEveryCategoryCost(t.thursday.workInfos)),i.set("friday",this.getEveryCategoryCost(t.friday.workInfos)),r.set("saturday",this.getEveryCategoryCost(t.saturday.workInfos)),l.set("sunday",this.getEveryCategoryCost(t.sunday.workInfos)),new Map([].concat(s(e),s(a),s(o),s(n),s(i),s(r),s(l)))},getSumCostByCategoryOneWeek:function(t){var e=0,a=0,s=0,o=0,n=0,i=0;return t.forEach(function(t,r){e+=t.coding,a+=t.testing,s+=t.documentWriting,o+=t.selfStudying,n+=t.translate,i+=t.useless}),[e,a,s,o,n,i]},getFormattedData:function(t){var e=this.transformTimeInterval(this.timeInterval),a=t.monday.sumCost+t.tuesday.sumCost+t.wednesday.sumCost+t.thursday.sumCost+t.friday.sumCost+t.saturday.sumCost+t.sunday.sumCost,s=(t.monday.sumCost>0?1:0)+(t.tuesday.sumCost>0?1:0)+(t.wednesday.sumCost>0?1:0)+(t.thursday.sumCost>0?1:0)+(t.friday.sumCost>0?1:0)+(t.saturday.sumCost>0?1:0)+(t.sunday.sumCost>0?1:0),o=this.getSumCostByCategoryOneWeek(this.calculateDailyCost(t));return[e,this.weekNumber,o,a,s,Number((a/s).toFixed(1)),Number(((o[0]+o[1]+o[2])/a).toFixed(2))].flat()},getEveryCategoryCost:function(t){var e={coding:0,testing:0,documentWriting:0,selfStudying:0,translate:0,useless:0};return t.map(function(t){switch(t.workCategory){case"编码":e.coding+=t.cost;break;case"测试":e.testing+=t.cost;break;case"文档编写":e.documentWriting+=t.cost;break;case"自学":e.selfStudying+=t.cost;break;case"翻译":e.translate+=t.cost;break;case"准备工作":e.useless+=t.cost}}),e},changeCurrentWeek:function(t){this.timeInterval=t;var e=new Date(t[0]),a=e.getFullYear(),s=e.getMonth(),o=e.getDate();this.weekData.monday.date=new Date(a,s,o),this.weekData.tuesday.date=new Date(a,s,o+1),this.weekData.wednesday.date=new Date(a,s,o+2),this.weekData.thursday.date=new Date(a,s,o+3),this.weekData.friday.date=new Date(a,s,o+4),this.weekData.saturday.date=new Date(a,s,o+5),this.weekData.sunday.date=new Date(a,s,o+6)}},test:function(){function t(){}var e=new t;console.log(e.hasOwnProperty("name")),console.log(e.__proto__),console.log("hasOwnProperty"in e)}}},668:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(649),o=a.n(s);e.default={props:{tableData:Object},components:{addMyDaily:o.a},computed:{currentDate:function(){var t=this.tableData.date;return t?t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate():"未选择"}},data:function(){return{title:[{title:"事项",key:"workName"},{title:"花费时间",key:"cost"},{title:"工作内容",key:"workCategory"}],formData:{},editDialogShown:!1,loading:!1}},methods:{openEditDialog:function(){this.formData={items:Object.assign([],this.tableData.workInfos),ps:this.tableData.ps,date:this.tableData.date},this.loading=!1,this.editDialogShown=!0},save:function(){this.loading=!0,this.tableData.ps=this.formData.ps,this.tableData.workInfos=Object.assign([],this.formData.items),this.tableData.sumCost=this.formData.sumCost,this.editDialogShown=!1},cancel:function(){this.editDialogShown=!1}}}},682:function(t,e){},689:function(t,e,a){var s=a(87)(a(668),a(701),null,null);s.options.__file="D:\\Apache24\\htdocs\\iview-project-3.0\\src\\views\\daily\\weekdayDailyDisplay.vue",s.esModule&&Object.keys(s.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),s.options.functional&&console.error("[vue-loader] weekdayDailyDisplay.vue: functional components are not supported with templates, they should use render functions."),t.exports=s.exports},700:function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{padding:"50px"}},[a("Row",{attrs:{type:"flex",justify:"start",align:"middle"}},[a("Col",{attrs:{span:"2"}},[a("p",[t._v("选择本周起止时间")])]),t._v(" "),a("Col",{attrs:{span:"4"}},[a("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"daterange",value:t.timeInterval,options:t.weekOptions,placeholder:"选择本周日报日期"},on:{"on-change":t.changeCurrentWeek}})],1),t._v(" "),a("Col",{attrs:{span:"2"}},[a("p",[t._v("选择周数")])]),t._v(" "),a("Col",{attrs:{span:"4"}},[a("InputNumber",{attrs:{min:1},model:{value:t.weekNumber,callback:function(e){t.weekNumber=e},expression:"weekNumber"}})],1),t._v(" "),a("Col",{attrs:{span:"4",offset:"8"}},[a("Tooltip",{attrs:{content:"保存当前周报",placement:"top"}},[a("Button",{attrs:{type:"success",disabled:t.loading},on:{click:t.save}},[t.loading?a("span",[t._v("保存中...请稍后")]):a("span",[t._v("保存周报")])])],1),t._v(" "),a("Button",{on:{click:t.goBack}},[t._v("返回")])],1)],1),t._v(" "),a("Divider"),t._v(" "),a("Tabs",{attrs:{type:"card"}},[a("TabPane",{attrs:{label:"详情"}},[a("Row",[a("Col",{attrs:{span:"10"}},[a("Table",{attrs:{size:"small",columns:t.tableTitle,data:t.weekDetail}})],1),t._v(" "),a("Col",{attrs:{span:"14"}},[a("div",{staticClass:"canvas-div",attrs:{id:"weekSumCostChart"}})])],1)],1),t._v(" "),a("TabPane",{attrs:{label:"周一"}},[a("weekdayDailyDisplay",{attrs:{"table-data":t.weekData.monday}})],1),t._v(" "),a("TabPane",{attrs:{label:"周二"}},[a("weekdayDailyDisplay",{attrs:{"table-data":t.weekData.tuesday}})],1),t._v(" "),a("TabPane",{attrs:{label:"周三"}},[a("weekdayDailyDisplay",{attrs:{"table-data":t.weekData.wednesday}})],1),t._v(" "),a("TabPane",{attrs:{label:"周四"}},[a("weekdayDailyDisplay",{attrs:{"table-data":t.weekData.thursday}})],1),t._v(" "),a("TabPane",{attrs:{label:"周五"}},[a("weekdayDailyDisplay",{attrs:{"table-data":t.weekData.friday}})],1),t._v(" "),a("TabPane",{attrs:{label:"周六"}},[a("weekdayDailyDisplay",{attrs:{"table-data":t.weekData.saturday}})],1),t._v(" "),a("TabPane",{attrs:{label:"周日"}},[a("weekdayDailyDisplay",{attrs:{"table-data":t.weekData.sunday}})],1)],1)],1)},staticRenderFns:[]},t.exports.render._withStripped=!0},701:function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",{attrs:{type:"flex",justify:"start",align:"middle"}},[a("Col",{attrs:{span:"4"}},[a("p",[t._v("日期："+t._s(t.currentDate))])]),t._v(" "),a("Col",{attrs:{span:"4",offset:"16"}},[a("Button",{attrs:{type:"primary"},on:{click:t.openEditDialog}},[t._v("编辑")])],1)],1),t._v(" "),a("Table",{attrs:{size:"large",columns:t.title,data:t.tableData.workInfos}}),t._v(" "),a("p",[t._v("总计 "+t._s(t.tableData.sumCost))]),t._v(" "),a("Input",{staticStyle:{width:"100%"},attrs:{type:"textarea",placeholder:"备注",autosize:{minRows:3,maxRows:5},readonly:!0},model:{value:t.tableData.ps,callback:function(e){t.$set(t.tableData,"ps",e)},expression:"tableData.ps"}}),t._v(" "),a("Modal",{attrs:{title:"填写日报",width:"80%","mask-closable":!1},model:{value:t.editDialogShown,callback:function(e){t.editDialogShown=e},expression:"editDialogShown"}},[a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{loading:t.loading},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),a("Button",{attrs:{type:"primary",loading:t.loading},on:{click:t.save}},[t.loading?a("span",[t._v("保存中...请稍后")]):a("span",[t._v("保存")])])],1),t._v(" "),a("addMyDaily",{attrs:{"form-data":t.formData,ps:t.tableData.ps}})],1)],1)},staticRenderFns:[]},t.exports.render._withStripped=!0}});