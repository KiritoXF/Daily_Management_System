webpackJsonp([2],{161:function(t,e,a){a(177);var r=a(5)(a(171),a(186),null,null);r.options.__file="d:\\Apache24\\htdocs\\iview-project-3.0\\src\\views\\my-daily\\myDaily.vue",r.esModule&&Object.keys(r.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),r.options.functional&&console.error("[vue-loader] myDaily.vue: functional components are not supported with templates, they should use render functions."),t.exports=r.exports},165:function(t,e,a){"use strict";var r={buildWorkloadCategoryChart:function(t,e,a,r){var n=t;new Chart(n,{type:"bar",data:{labels:a,datasets:[{label:r,backgroundColor:"rgb(255, 99, 132)",borderColor:"rgb(255, 99, 132)",data:e}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})}};e.a=r},171:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(165);e.default={mounted:function(){this.importCSV(),this.getAllInfos()},data:function(){return{columns:[{title:"时间",key:"timeInterval"},{title:"周数",key:"weeks"},{title:"工作内容",align:"center",children:[{title:"编码",key:"coding"},{title:"测试",key:"testing"},{title:"文档编写",key:"documentWriting"},{title:"自学",key:"selfStudying"},{title:"翻译",key:"translate"},{title:"准备工作",key:"useless"}]},{title:"本周工作量",key:"weekWorkload"},{title:"工作日",key:"weekday"},{title:"日均工作量",key:"averageWorkload"},{title:"工作饱和度",key:"workSaturation"},{title:"Action",slot:"action"}],infos:[]}},methods:{addWeekDaily:function(){this.$router.push({path:"/myDaily/weekDaily",name:"weekDaily",params:{tableData:[]}})},getAllInfos:function(){var t=this,e=this;this.$http.get("/api/myDaily/getAllData",{}).then(function(a){t.infos=e.addCssToData(a.body),r.a.buildWorkloadCategoryChart("workloadCategoryChart",t.handleData(t.infos).category,["编码","测试","文档编写","自学","翻译","准备工作"],"各种类工作时长直方图"),t.buildSumWorkloadChart(),t.buildEveryWorkloadCategoryChart()})},addCssToData:function(t){return t.map(function(t){return t.cellClassName={},t.cellClassName.weekWorkload=t.weekWorkload>40?"over-work":"ok-work",t.cellClassName.weekday=t.weekday>5?"over-work":"ok-work",t.cellClassName.averageWorkload=t.averageWorkload>8?"over-work":"ok-work",t.workSaturation=(100*t.workSaturation).toFixed(1)+"%",t})},importInfos:function(t){this.$http.post("/api/myDaily/importOriginData",{infos:t},{}).then(function(t){console.log(t)})},edit:function(t){this.$router.push({path:"/myDaily/weekDaily",name:"weekDaily",params:{infos:this.infos[t]}})},handleData:function(t){var e={coding:0,testing:0,documentWriting:0,selfStudying:0,translate:0,useless:0};return t.map(function(t){e.coding+=t.coding,e.testing+=t.testing,e.documentWriting+=t.documentWriting,e.selfStudying+=t.selfStudying,e.translate+=t.translate,e.useless+=t.useless}),{category:[e.coding,e.testing,e.documentWriting,e.selfStudying,e.translate,e.useless],sumWorkload:t.map(function(t){return t.weekWorkload}),infos:t}},buildSumWorkloadChart:function(){var t=this.handleData(this.infos).sumWorkload;new Chart("sumWorkloadChart",{type:"line",data:{labels:t.map(function(t,e){return"第"+(e+1)+"周"}),datasets:[{label:"总工作量变化折线图",borderColor:"rgb(255, 99, 132)",data:t}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})},buildEveryWorkloadCategoryChart:function(){var t=this.handleData(this.infos).infos;new Chart("everyWorkloadCategoryChart",{type:"line",data:{labels:t.map(function(t,e){return"第"+(e+1)+"周"}),lineTension:0,datasets:[{label:"编码",borderColor:"#58B2DC",data:t.map(function(t){return t.coding})},{label:"测试",borderColor:"#00AA90",data:t.map(function(t){return t.testing})},{label:"文档编写",borderColor:"#FAD689",data:t.map(function(t){return t.documentWriting})},{label:"自学",borderColor:"#DC9FB4",data:t.map(function(t){return t.selfStudying})},{label:"准备工作",borderColor:"#FEDFE1",data:t.map(function(t){return t.useless})}]},options:{}})},handleImportData:function(t){if(t[0].length>70)return!1;var e=[];t[0].map(function(t,a){e.push({timeInterval:t[0],weeks:Number(t[1]),coding:Number(t[2]),testing:Number(t[3]),documentWriting:Number(t[4]),selfStudying:Number(t[6]),translate:0,useless:Number(t[8]),weekWorkload:Number(t[9]),weekday:Number(t[10]),averageWorkload:Number(t[11]),workSaturation:(Number(t[2])+Number(t[3])+Number(t[4]))/Number(t[9])})});var a=e.map(function(t){return[t.timeInterval,t.weeks,t.coding,t.testing,t.documentWriting,t.selfStudying,t.translate,t.useless,t.weekWorkload,t.weekday,t.averageWorkload,t.workSaturation]});this.infos=e,this.importInfos(a),r.a.buildWorkloadCategoryChart("workloadCategoryChart",this.handleData(this.infos).category,["编码","测试","文档编写","自学","翻译","准备工作"],"各种类工作时长直方图"),this.buildSumWorkloadChart(),this.buildEveryWorkloadCategoryChart()},importCSV:function(t,e){var a=this;document.querySelector("input").addEventListener("change",function(){r(this.files,function(t){a.handleImportData(t)})},!1);var r=function(t,e){function r(t){return t.trim().split(/\n/gm).map(function(t){t=t.replace("\r","");var e=t.match(/"[^"]+"/gi);if(e){var a=e.map(function(t){return t.replace(/,/g,"<|>")});e.forEach(function(e,r){t=t.replace(e,a[r])})}return t.split(" ")})}if(!t instanceof FileList)return[];var n=0,o=[];[].slice.call(t).forEach(function(e){var i=new FileReader;i.onload=function(e){o.push(r(e.target.result)),++n==t.length&&a.handleImportData(o)},i.readAsText(e,"UTF-8")})}}}}},177:function(t,e){},186:function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{padding:"0 10px"}},[a("Tabs",{attrs:{type:"card",animated:!1}},[a("TabPane",{attrs:{label:"原始数据"}},[a("input",{staticClass:"importBox",attrs:{type:"file",multiple:""}}),t._v(" "),a("Button",{attrs:{type:"primary"},on:{click:t.addWeekDaily}},[t._v("新增周报")]),t._v(" "),a("Table",{ref:"infoTable",staticStyle:{margin:"0 auto",padding:"0px"},attrs:{border:"",columns:t.columns,data:t.infos,ellipsis:""},scopedSlots:t._u([{key:"id",fn:function(e){var r=e.row;return[a("strong",[t._v(t._s(r.date))])]}},{key:"action",fn:function(e){var r=(e.row,e.index);return[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(e){t.view(r)}}},[t._v("详情")]),t._v(" "),a("Button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.edit(r)}}},[t._v("填写")])]}}])})],1),t._v(" "),a("TabPane",{attrs:{label:"加班记录表"}},[t._v("以后再做")]),t._v(" "),a("TabPane",{attrs:{label:"各种类工作时长"}},[a("div",{staticClass:"canvas-div"},[a("canvas",{attrs:{id:"workloadCategoryChart"}})])]),t._v(" "),a("TabPane",{attrs:{label:"总工作量"}},[a("div",{staticClass:"canvas-div"},[a("canvas",{attrs:{id:"sumWorkloadChart"}})])]),t._v(" "),a("TabPane",{attrs:{label:"各工作类型时间变化"}},[a("div",{staticClass:"canvas-div"},[a("canvas",{attrs:{id:"everyWorkloadCategoryChart"}})])])],1)],1)},staticRenderFns:[]},t.exports.render._withStripped=!0}});